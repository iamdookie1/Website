<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Morse Decoder</title>
<style>
body {
    background: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 40px;
}
.container {
    max-width: 700px;
    margin: auto;
    text-align: center;
}
button, input {
    background: #111;
    color: #fff;
    border: 1px solid #444;
    padding: 12px 20px;
    margin: 10px;
    cursor: pointer;
}
button:hover, input:hover {
    background: #222;
}
#output {
    margin-top: 30px;
    font-size: 20px;
    word-wrap: break-word;
}
</style>
</head>
<body>
<div class="container">
    <h1>Morse Code Image Decoder</h1>

    <button id="translateUI">Translate UI</button>
    <input type="file" id="imageInput" accept="image/*">
    <div id="output"></div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
const uiStrings = {
    en: { title: "Morse Code Image Decoder", translate: "Translate UI", result: "Decoded Text:" },
    es: { title: "Decodificador de CÃ³digo Morse", translate: "Traducir Interfaz", result: "Texto Decodificado:" }
};

let currentLang = "en";

document.getElementById("translateUI").onclick = () => {
    currentLang = currentLang === "en" ? "es" : "en";
    document.querySelector("h1").textContent = uiStrings[currentLang].title;
    document.getElementById("translateUI").textContent = uiStrings[currentLang].translate;
};

document.getElementById("imageInput").onchange = async e => {
    const file = e.target.files[0];
    if (!file) return;

    const img = new Image();
    img.src = URL.createObjectURL(file);
    img.onload = () => processImage(img);
};

function processImage(img) {
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = img.width;
    canvas.height = img.height;

    ctx.drawImage(img, 0, 0);

    const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;

    let morse = "";

    for (let i = 0; i < data.length; i += 4) {
        const brightness = (data[i] + data[i+1] + data[i+2]) / 3;

        if (brightness > 200) morse += ".";
        else if (brightness < 50) morse += "-";
        else morse += " ";
    }

    morse = morse.replace(/ +/g, "   ");

    const morseMap = {
        ".-":"A","-...":"B","-.-.":"C","-..":"D",".":"E","..-.":"F","--.":"G","....":"H","..":"I",
        ".---":"J","-.-":"K",".-..":"L","--":"M","-.":"N","---":"O",".--.":"P","--.-":"Q",".-.":"R",
        "...":"S","-":"T","..-":"U","...-":"V",".--":"W","-..-":"X","-.--":"Y","--..":"Z",
        "-----":"0",".----":"1","..---":"2","...--":"3","....-":"4",".....":"5","-....":"6",
        "--...":"7","---..":"8","----.":"9",
        "-..-.":"/"
    };

    const words = morse.trim().split("   ");
    let decoded = "";

    for (const word of words) {
        const letters = word.split(" ");
        for (const l of letters) decoded += morseMap[l] || "";
        decoded += " ";
    }

    document.getElementById("output").textContent =
        uiStrings[currentLang].result + " " + decoded.trim();
}
</script>
</body>
</html>
